theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.title = element_text(face = "bold", size = rel(2)),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(y=year,x=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "inferno") +
labs(y = NULL) +theme_classic()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.title = element_text(face = "bold", size = rel(2)),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(y=year,x=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_y_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "inferno") +
labs(y = NULL) +theme_classic()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.title = element_text(face = "bold", size = rel(2)),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "inferno") +
labs(y = NULL) +theme_classic()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.title = element_text(face = "bold", size = rel(2)),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "inferno") +
labs(y = NULL) +theme_classic()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(face = "bold", size = rel(2)))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
?scale_fill_viridis
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_classic()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white",width=5) +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white",size=5) +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white",size=.1) +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),size=.1) +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white",size=2) +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
strip.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.text = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 12, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Fødsler per 1000 pers. i Danmark",
caption = "Data: Danmarks Statistik")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18, face = "bold"),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Monthly Births per 1000 in Denmark",
caption = "Data source: Statistics Denmark")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 6))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
# create chart
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 10))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "heat")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 10))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_color_brewer(palette="Dark2")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 10))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_color_brewer(palette="heat")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 10))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "cividis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 10))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
ggplot(df,aes(x=year,y=month))+
geom_tile(aes(fill = birthrate),colour="white") +
scale_x_discrete(breaks = seq(1901, 2019, 10)) +
scale_fill_viridis(option = "viridis")+
labs(y = NULL) +theme_minimal()+
theme(legend.position = "top",
legend.justification = "left",
legend.title = element_text(size = 18),
plot.caption = element_text(size = 10))+
labs(x = " ",     fill = "Monthly Births per 1000 Population in Denmark, 1901-2019",
caption = "Data source: Statistics Denmark")
ggsave("fig.png")
library("rvest")
url <- "http://en.wikipedia.org/wiki/List_of_U.S._states_and_territories_by_population"
library("rvest")
url <- "http://www.igmchicago.org/participants/daron-acemoglu"
test <- url %>%
html()
test
test <- url %>%
html()%>%
html_node(xpath='/html/body/div[5]/div[1]/div[3]/table[1]')%>%
html_table()
test <- url %>%
html()%>%
html_node(xpath='/html/body/div[5]/div[1]/div[3]/table[1]')
test
library("rvest")
url <- "http://www.igmchicago.org/participants/daron-acemoglu"
test <- url %>%
html()%>%
html_node(xpath='//*[contains(concat( " ", @class, " " ), concat( " ", "survey", " " ))] | //th')
url <- "http://www.igmchicago.org/participants/daron-acemoglu"
test <- url %>%
html()
test
test2<-test[2]
test2
test[1]
test[2]
test[[2]]
test$node
test$doc
library(xml2)
webpage <- xml2::read_html(url)
webpage <- xml2::read_html(url)
webpage
View(test)
webpage <- read_html(url)
library("rvest")
url <- "http://www.igmchicago.org/participants/daron-acemoglu"
webpage <- read_html(url)
test <- url %>%
read_html() %>%
html_nodes(xpath='//*[@class="survey"]')
test
webpage <- read_html(url)
View(webpage)
setwd ("C:\\Github\\igm_survey_gender\\scraping")
library("tidyverse")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("data_output_US.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("usgender.csv")????
df_m<-merge(df7,gender,by="Name")
setwd ("C:\\Github\\igm_survey_gender\\scraping")
library("tidyverse")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("data_output_US.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("usgender.csv")
# merge
df_m<-merge(df7,gender,by="Name")
View(df_m)
df_m<-merge(df7,gender,by="Name")
df_m<-merge(df_m,df2,by=c("Name","Question"))
View(df_m)
df_m<-merge(df7,gender,by="Name")
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df7,gender,by="Name")
View(df_m)
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df_m,df3,by=c("Name","Question"))
df_m<-merge(df_m,df4,by=c("Name","Question"))
df_m<-merge(df_m,df6,by=c("Name","Question"))
df_m<-merge(df_m,df5,by=c("Name","Question"))%>%
mutate(Question=as.numeric(str_remove(Question, "CONF_")))%>%
arrange(Name,Question)%>%
filter(!is.na(Medianconf))
View(df_m)
save.dta13(df_m,"cleaned_data_US.dta")
setwd ("C:\\Github\\igm_survey_gender\\scraping")
library("tidyverse")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("data_output_eu.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("eugender.csv")
# merge
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df_m,df3,by=c("Name","Question"))
df_m<-merge(df_m,df4,by=c("Name","Question"))
df_m<-merge(df_m,df6,by=c("Name","Question"))
df_m<-merge(df_m,df5,by=c("Name","Question"))%>%
mutate(Question=as.numeric(str_remove(Question, "CONF_")))%>%
arrange(Name,Question)%>%
filter(!is.na(Medianconf))
View(df_m)
setwd ("C:\\Github\\igm_survey_gender\\scraping")
library("tidyverse")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("data_output_eu.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("eugender.csv")
# merge
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df_m,df3,by=c("Name","Question"))
df_m<-merge(df_m,df4,by=c("Name","Question"))
df_m<-merge(df_m,df6,by=c("Name","Question"))
df_m<-merge(df_m,df5,by=c("Name","Question"))%>%
mutate(Question=as.numeric(str_remove(Question, "CONF_")))%>%
arrange(Name,Question)%>%
filter(!is.na(Medianconf))
View(df_m)
save.dta13(df_m,"cleaned_data_EU.dta")
