votes[i,votes_g2]<-5
# Vote 7
v<-sample(votes_g6,1)
votes[i,v]<-4
votes_g6<-votes_g6[votes_g6!=v]
# vote 8
v<-sample(votes_g3,1)
votes[i,votes_g3]<-3
# Vote 9
v<-sample(votes_g6,1)
votes[i,v]<-2
votes_g6<-votes_g6[votes_g6!=v]
# vote 10
v<-sample(votes_g6,1)
votes[i,v]<-1
votes_g6<-votes_g6[votes_g6!=v]
# Vote 11
v<-sample(votes_g6,1)
votes[i,votes_g6]<-0
votes[i,12]=i
i=i+1
}
a<-data.frame(group=c("Author 1","Author 1","Author 1","Author 1","Author 1","Author 1",
"Author 2","Author 2","Author 2","Author 3","Author 3"),
rank=colMeans(votes[,1:11]))%>%arrange(rank)%>%
mutate(order=1:11)
ggplot(a,aes(x=order,y=rank,fill=group))+geom_bar(stat="identity")
rm(list=ls())
library("tidyverse")
df<-tibble(x=0,y=1,col=1)
df<-tibble(x=c(0,0),y=(0,1),col=c(1,1))
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1))
ggplot(df,aes(x=x,y=y,colour=y))
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df2<-rbind(df1,df2)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df2<-rbind(df1,df1)
View(df2)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1)
View(df1)
View(df)
df1<-rbind(df1,df1)%>%
mutate(count=1:2)
df1<-rbind(df1,df1)%>%
mutate(count=row())
df1<-rbind(df1,df1)%>%
mutate(count=row_number())
View(df1)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1)%>%
mutate(count=row_number())
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,f1)%>%
mutate(count=row_number())
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number())
View(df1)
View(df1)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number().
y=ifelse(count>2,y+1,y)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number().
y=ifelse(count>2,y+1,y))
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number().
y=ifelse(count>2,y+1,y))
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y))
View(df1)
runif()
runif(1)
?runif()
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(0,0),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count>2,x*runif(1, min = 0.95, max = 1.05),y))
View(df1)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count>2,x*runif(1, min = 0.95, max = 1.05),y))
View(df)
View(df1)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count=3,x*runif(1, min = 0.95, max = 1.05),y),
x=ifelse(count=4,x*runif(1, min = 0.95, max = 1.05),y))
View(df1)
View(df1)
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count=3,x*runif(1, min = 0.95, max = 1.05),y),
x=ifelse(count=4,x*runif(1, min = 0.95, max = 1.05),y))
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count=3,x*runif(1, min = 0.95, max = 1.05),x),
x=ifelse(count=4,x*runif(1, min = 0.95, max = 1.05),x))
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count==3,x*runif(1, min = 0.95, max = 1.05),x),
x=ifelse(count==4,x*runif(1, min = 0.95, max = 1.05),x))
View(df1)
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count==3,x*runif(1, min = 0.95, max = 1.05),x),
x=ifelse(count==4,x*runif(1, min = 0.95, max = 1.05),x))
ggplot(df,aes(x=x,y=y,colour=y))+geom_line()
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count==3,x*runif(1, min = 0.95, max = 1.05),x),
x=ifelse(count==4,x*runif(1, min = 0.95, max = 1.05),x))
ggplot(df,aes(x=x,y=y,colour=col))+geom_line()
rm(list=ls())
library("tidyverse")
df<-tibble(x=c(1,1),y=c(0,1),col=c(1,1),count=1:2)
df1<-df%>%
filter(count==2)%>%
mutate(col=2)
df1<-rbind(df1,df1,df1,df1)%>%
mutate(count=row_number(),
y=ifelse(count>2,y+1,y),
x=ifelse(count==3,x*runif(1, min = 0.95, max = 1.05),x),
x=ifelse(count==4,x*runif(1, min = 0.95, max = 1.05),x))
ggplot(rbind(df,df1),aes(x=x,y=y,colour=col))+geom_line()
View(df1)
setwd ("C:\\Github\\igm_survey_gender")
library("tidyverse")
library("readxl")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("scraping//data_output_us.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("manualdata//usgender.csv")
# topic
topic<-read_excel("manualdata//qtext_us.xlsx")
# merge
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df_m,df3,by=c("Name","Question"))
df_m<-merge(df_m,df4,by=c("Name","Question"))
df_m<-merge(df_m,df6,by=c("Name","Question"))
df_m<-merge(df_m,df5,by=c("Name","Question"))%>%
mutate(Question=as.numeric(str_remove(Question, "CONF_")))%>%
arrange(Name,Question)%>%
filter(!is.na(Medianconf))
# qtext
df_m<-merge(df_m,topic,by="Qtext")
# write to Stata
write_excel_csv(df_m,"datacleaning/cleaned_data_US.csv")
save.dta13(df_m,"datacleaning/cleaned_data_US.dta")
# Plot
#ggplot(df4,aes(x=Deviation_from_median_confidence))+geom_bar()
View(df_m)
View(df6)
write_excel_csv(df6,"questions.csv")
setwd ("C:\\Github\\igm_survey_gender")
library("tidyverse")
library("readxl")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("scraping//data_output_eu.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
setwd ("C:\\Github\\igm_survey_gender")
library("tidyverse")
library("readxl")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("scraping//data_output_eu.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
View(df6)
write_excel_csv(df6%>%filter(Name=="Nicholas Bloom"),"questionsEU.csv")
?merge
setwd ("C:\\Github\\igm_survey_gender")
library("tidyverse")
library("readxl")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("scraping//data_output_eu.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
write_excel_csv(df6%>%filter(Name=="Nicholas Bloom"),"questionsEU.csv")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("manualdata//eugender.csv")
# topic
topic<-read_excel("manualdata//qtext_eu.xlsx")
# merge
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df_m,df3,by=c("Name","Question"))
df_m<-merge(df_m,df4,by=c("Name","Question"))
df_m<-merge(df_m,df6,by=c("Name","Question"),all.x = TRUE)
df_m<-merge(df_m,df5,by=c("Name","Question"))%>%
mutate(Question=as.numeric(str_remove(Question, "CONF_")))%>%
arrange(Name,Question)%>%
filter(!is.na(Medianconf))
# qtext
df_m<-merge(df_m,topic,by="Qtext")
# write to Stata
write_excel_csv(df_m,"datacleaning/cleaned_data_EU.csv")
save.dta13(df_m,"datacleaning/cleaned_data_EU.dta")
# Plot
#ggplot(df4,aes(x=Deviation_from_median_confidence))+geom_bar()
setwd ("C:\\Github\\igm_survey_gender")
library("tidyverse")
library("readxl")
library("readstata13")
library(stringr)
rm(list=ls())
# load data
df<-read_delim("scraping//data_output_us.csv",delim="|")
# Confidence
df1<-df%>%select(Confidence,Name)%>%
separate(Confidence,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Confidence")%>%
mutate(Confidence=as.numeric(Confidence))
# Medianconf
df2<-df%>%select(Medianconf,Name)%>%
separate(Medianconf,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Medianconf")%>%
mutate(Medianconf=as.numeric(Medianconf))
# Vote
df3<-df%>%select(Votes,Name)%>%
separate(Votes,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Vote")
# Median Vote
df4<-df%>%select(Median,Name)%>%
separate(Median,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Median")
# Comment
df5<-df%>%select(Comment,Name)%>%
separate(Comment,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Comment")
# Question
df6<-df%>%select(Questions,Name)%>%
separate(Questions,into = paste("CONF", 1:1000, sep = "_"),sep="¦")%>%
pivot_longer(1:1000, names_to="Question",values_to = "Qtext")
write_excel_csv(df6,"questionsUS.csv")
# Institution
df7<-df%>%select(Profile,Name)%>%
mutate(Profile=str_remove(Profile, Name),
Profile=str_remove(Profile, "Personal Homepage"),
Profile=str_trim(Profile))%>%
rename(Institution=Profile)
# gender
gender<-read_csv("manualdata//usgender.csv")
# topic
topic<-read_excel("manualdata//qtext_us.xlsx")
# merge
df_m<-merge(gender,df1,by=c("Name"))
df_m<-merge(df_m,df2,by=c("Name","Question"))
df_m<-merge(df_m,df3,by=c("Name","Question"))
df_m<-merge(df_m,df4,by=c("Name","Question"))
df_m<-merge(df_m,df6,by=c("Name","Question"),all.x = TRUE)
df_m<-merge(df_m,df5,by=c("Name","Question"))%>%
mutate(Question=as.numeric(str_remove(Question, "CONF_")))%>%
arrange(Name,Question)%>%
filter(!is.na(Medianconf))
# qtext
df_m<-merge(df_m,topic,by="Qtext")
# write to Stata
write_excel_csv(df_m,"datacleaning/cleaned_data_US.csv")
save.dta13(df_m,"datacleaning/cleaned_data_US.dta")
# Plot
#ggplot(df4,aes(x=Deviation_from_median_confidence))+geom_bar()
br
